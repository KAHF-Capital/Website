"use strict";(()=>{var e={};e.id=220,e.ids=[220],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3856:(e,r,t)=>{t.r(r),t.d(r,{config:()=>u,default:()=>p,routeModule:()=>d});var a={};t.r(a),t.d(a,{default:()=>s});var o=t(1802),i=t(7153),l=t(6249),n=t(5849);async function s(e,r){if("POST"!==e.method)return r.status(405).json({error:"Method not allowed"});let{ticker:t,shortCallStrike:a,shortPutStrike:o,longCallStrike:i,longPutStrike:l,totalCredit:s,totalDebit:p,currentPrice:u,daysToExpiration:d}=e.body,v=parseFloat(a),c=parseFloat(o),h=parseFloat(i),g=parseFloat(l);if(!t||isNaN(v)||isNaN(c)||isNaN(h)||isNaN(g))return r.status(400).json({error:"Missing required parameters: ticker and all strike prices are required",details:{ticker:!!t,shortCallStrike:v,shortPutStrike:c,longCallStrike:h,longPutStrike:g}});if(g>=c||c>v||v>=h)return r.status(400).json({error:"Invalid Iron Condor setup. Strikes must follow: Long Put < Short Put â‰¤ Short Call < Long Call",details:{longPutStrike:g,shortPutStrike:c,shortCallStrike:v,longCallStrike:h,validation:{longPutLessThanShortPut:g<c,shortPutLessOrEqualShortCall:c<=v,shortCallLessThanLongCall:v<h}}});let m=u||v;try{let e=(s||0)-(p||0),a=v+e,o=c-e;if(!m||m<=0)throw Error(`Invalid effective price: ${m}. Please provide a valid current price.`);let i=(a-m)/m,l=(o-m)/m;if(!isFinite(i)||!isFinite(l))throw Error(`Invalid breakeven calculations. Upper: ${i}, Lower: ${l}`);let u=new Date().toISOString().split("T")[0],h=new Date(Date.now()-(d+30)*864e5).toISOString().split("T")[0],g=await (0,n.rK)(t,h,u),P=(0,n.gd)(g,d||30),f=function(e,r,t,a,o,i){try{console.log(`Starting Iron Condor profitability analysis with ${e?e.length:0} data points`),console.log(`Breakeven percentages: upper=${r}, lower=${t}`);let a=0,o=0,i=0,l=0;if(!e||0===e.length)return console.log("No historical data available for analysis"),{inProfitZone:0,aboveUpperBreakeven:0,belowLowerBreakeven:0,totalSamples:0,profitableRate:0,maxProfitProbability:0,maxLossProbability:0,upperBreakevenPct:100*(r||0),lowerBreakevenPct:100*(t||0),avgMove:0,maxMove:0,minMove:0,dataQuality:"none"};let n=e.filter(e=>.5>=Math.abs(e.percentMove));0===n.length&&(n=e),n.forEach(e=>{let n=e.percentMove;n<r&&n>t&&a++,n>=r&&o++,n<=t&&i++,l++});let s=l>0?a/l*100:0,p=l>0?(o+i)/l*100:0,u=n.length>0?n.reduce((e,r)=>e+Math.abs(r.percentMove),0)/n.length:0,d=n.length>0?Math.max(...n.map(e=>Math.abs(e.percentMove))):0,v=n.length>0?Math.min(...n.map(e=>Math.abs(e.percentMove))):0;return console.log(`Analysis completed: ${a}/${l} profitable (${s.toFixed(1)}%)`),{inProfitZone:a,aboveUpperBreakeven:o,belowLowerBreakeven:i,totalSamples:l,profitableRate:s,maxProfitProbability:s,maxLossProbability:p,upperBreakevenPct:100*(r||0),lowerBreakevenPct:100*(t||0),avgMove:100*u,maxMove:100*d,minMove:100*v,dataQuality:l>=50?"high":l>=20?"medium":l>=5?"low":"limited"}}catch(e){return console.error("Error in analyzeIronCondorProfitability:",e),{inProfitZone:0,aboveUpperBreakeven:0,belowLowerBreakeven:0,totalSamples:0,profitableRate:0,maxProfitProbability:0,maxLossProbability:0,upperBreakevenPct:100*(r||0),lowerBreakevenPct:100*(t||0),avgMove:0,maxMove:0,minMove:0,dataQuality:"error",error:e.message}}}(P,i,l,0,0,0);r.status(200).json(f)}catch(e){console.error("Error in Iron Condor analysis:",e),r.status(500).json({error:"Failed to perform analysis",details:"Please try again later",errorType:e.name,ticker:t})}}let p=(0,l.l)(a,"default"),u=(0,l.l)(a,"config"),d=new o.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/iron-condor-analysis",pathname:"/api/iron-condor-analysis",bundlePath:"",filename:""},userland:a})}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[485],()=>t(3856));module.exports=a})();