"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/darkpool-trades";
exports.ids = ["pages/api/darkpool-trades"];
exports.modules = {

/***/ "csv-parser":
/*!*****************************!*\
  !*** external "csv-parser" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("csv-parser");

/***/ }),

/***/ "csv-writer":
/*!*****************************!*\
  !*** external "csv-writer" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("csv-writer");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdarkpool-trades&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdarkpool-trades.js&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdarkpool-trades&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdarkpool-trades.js&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_darkpool_trades_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\darkpool-trades.js */ \"(api)/./pages/api/darkpool-trades.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_darkpool_trades_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_darkpool_trades_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/darkpool-trades\",\n        pathname: \"/api/darkpool-trades\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_darkpool_trades_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmRhcmtwb29sLXRyYWRlcyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDZGFya3Bvb2wtdHJhZGVzLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzZEO0FBQzdEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQywwREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsMERBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8va2FoZi1jYXBpdGFsLXdlYnNpdGUvPzNlMmIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFxkYXJrcG9vbC10cmFkZXMuanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9kYXJrcG9vbC10cmFkZXNcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9kYXJrcG9vbC10cmFkZXNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdarkpool-trades&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdarkpool-trades.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/darkpool-trades.js":
/*!**************************************!*\
  !*** ./pages/api/darkpool-trades.js ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\nconst fs = __webpack_require__(/*! fs */ \"fs\");\nconst path = __webpack_require__(/*! path */ \"path\");\nconst csv = __webpack_require__(/*! csv-parser */ \"csv-parser\");\nconst createCsvWriter = (__webpack_require__(/*! csv-writer */ \"csv-writer\").createObjectCsvWriter);\n// Data directory for CSV files\nconst DATA_DIR = path.join(process.cwd(), \"data\");\nconst DAILY_CSV_DIR = path.join(DATA_DIR, \"daily\");\nconst HISTORICAL_CSV_PATH = path.join(DATA_DIR, \"darkpool_history.csv\");\n// Ensure directories exist\nfunction ensureDirectories() {\n    if (!fs.existsSync(DATA_DIR)) {\n        fs.mkdirSync(DATA_DIR, {\n            recursive: true\n        });\n    }\n    if (!fs.existsSync(DAILY_CSV_DIR)) {\n        fs.mkdirSync(DAILY_CSV_DIR, {\n            recursive: true\n        });\n    }\n}\n// Parse CSV file and extract dark pool trades with memory limits\nfunction parseDarkPoolTrades(csvFilePath) {\n    return new Promise((resolve, reject)=>{\n        const darkPoolTrades = [];\n        let rowCount = 0;\n        const MAX_ROWS = 10000; // Limit to 10k rows to prevent memory issues\n        fs.createReadStream(csvFilePath).pipe(csv()).on(\"data\", (row)=>{\n            rowCount++;\n            // Stop processing if we hit the limit\n            if (rowCount > MAX_ROWS) {\n                console.log(`Reached row limit (${MAX_ROWS}), stopping processing`);\n                return;\n            }\n            // Check if this is a dark pool trade\n            // Dark pool trades have exchange = 4 AND trf_id present\n            if (row.exchange === \"4\" && row.trf_id && row.trf_id.trim() !== \"\") {\n                darkPoolTrades.push({\n                    ticker: row.ticker || row.symbol || \"UNKNOWN\",\n                    volume: parseInt(row.size || row.volume || 0),\n                    price: parseFloat(row.price || row.p || 0),\n                    timestamp: row.timestamp || row.t || new Date().toISOString(),\n                    exchange: row.exchange,\n                    trf_id: row.trf_id\n                });\n            }\n        }).on(\"end\", ()=>{\n            console.log(`Processed ${rowCount} rows, found ${darkPoolTrades.length} dark pool trades`);\n            resolve(darkPoolTrades);\n        }).on(\"error\", (error)=>{\n            reject(error);\n        });\n    });\n}\n// Group dark pool trades by ticker and calculate totals\nfunction groupTradesByTicker(trades) {\n    const tickerMap = {};\n    trades.forEach((trade)=>{\n        const ticker = trade.ticker.toUpperCase();\n        if (!tickerMap[ticker]) {\n            tickerMap[ticker] = {\n                ticker: ticker,\n                total_volume: 0,\n                trade_count: 0,\n                avg_price: 0,\n                total_value: 0\n            };\n        }\n        tickerMap[ticker].total_volume += trade.volume;\n        tickerMap[ticker].trade_count += 1;\n        tickerMap[ticker].total_value += trade.volume * trade.price;\n    });\n    // Calculate average price\n    Object.values(tickerMap).forEach((tickerData)=>{\n        tickerData.avg_price = tickerData.total_value / tickerData.total_volume;\n    });\n    // Convert to array and sort by volume\n    return Object.values(tickerMap).sort((a, b)=>b.total_volume - a.total_volume);\n}\n// Save dark pool data to historical CSV\nfunction saveToHistoricalCSV(trades, date) {\n    const csvWriter = createCsvWriter({\n        path: HISTORICAL_CSV_PATH,\n        header: [\n            {\n                id: \"date\",\n                title: \"DATE\"\n            },\n            {\n                id: \"ticker\",\n                title: \"TICKER\"\n            },\n            {\n                id: \"total_volume\",\n                title: \"TOTAL_VOLUME\"\n            },\n            {\n                id: \"trade_count\",\n                title: \"TRADE_COUNT\"\n            },\n            {\n                id: \"avg_price\",\n                title: \"AVG_PRICE\"\n            },\n            {\n                id: \"total_value\",\n                title: \"TOTAL_VALUE\"\n            }\n        ],\n        append: fs.existsSync(HISTORICAL_CSV_PATH)\n    });\n    const records = trades.map((trade)=>({\n            date: date,\n            ticker: trade.ticker,\n            total_volume: trade.total_volume,\n            trade_count: trade.trade_count,\n            avg_price: trade.avg_price.toFixed(2),\n            total_value: trade.total_value.toFixed(2)\n        }));\n    return csvWriter.writeRecords(records);\n}\n// Get latest CSV file from daily directory (prefer smaller files for testing)\nfunction getLatestCSVFile() {\n    const files = fs.readdirSync(DAILY_CSV_DIR).filter((file)=>file.endsWith(\".csv\")).map((file)=>{\n        const filePath = path.join(DAILY_CSV_DIR, file);\n        const stats = fs.statSync(filePath);\n        return {\n            name: file,\n            path: filePath,\n            mtime: stats.mtime,\n            size: stats.size\n        };\n    }).sort((a, b)=>{\n        // Prefer smaller files (like test.csv) over large files\n        if (a.size < 1000000 && b.size >= 1000000) return -1;\n        if (b.size < 1000000 && a.size >= 1000000) return 1;\n        // Then sort by modification time\n        return b.mtime - a.mtime;\n    });\n    return files.length > 0 ? files[0] : null;\n}\nasync function handler(req, res) {\n    if (req.method !== \"GET\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        ensureDirectories();\n        const { save = \"false\" } = req.query;\n        const currentDate = new Date().toISOString().split(\"T\")[0];\n        // Get the latest CSV file\n        const latestFile = getLatestCSVFile();\n        if (!latestFile) {\n            return res.status(404).json({\n                error: \"No CSV files found\",\n                message: `Please upload a CSV file to the ${DAILY_CSV_DIR} directory`,\n                instructions: [\n                    \"1. Download your Polygon.io CSV file\",\n                    \"2. Upload it to the data/daily folder\",\n                    \"3. Refresh this page to analyze the data\"\n                ]\n            });\n        }\n        console.log(`Processing CSV file: ${latestFile.name}`);\n        // Parse the CSV file\n        const darkPoolTrades = await parseDarkPoolTrades(latestFile.path);\n        if (darkPoolTrades.length === 0) {\n            return res.status(200).json({\n                date: currentDate,\n                trades: [],\n                total_tickers: 0,\n                last_updated: new Date().toISOString(),\n                message: \"No dark pool trades found in the CSV file\",\n                file_processed: latestFile.name\n            });\n        }\n        // Group trades by ticker\n        const groupedTrades = groupTradesByTicker(darkPoolTrades);\n        // Save to historical CSV if requested\n        if (save === \"true\") {\n            try {\n                await saveToHistoricalCSV(groupedTrades, currentDate);\n                console.log(`Saved ${groupedTrades.length} tickers to historical CSV`);\n            } catch (error) {\n                console.error(\"Error saving to historical CSV:\", error);\n            }\n        }\n        return res.status(200).json({\n            date: currentDate,\n            trades: groupedTrades,\n            total_tickers: groupedTrades.length,\n            total_trades: darkPoolTrades.length,\n            last_updated: new Date().toISOString(),\n            file_processed: latestFile.name,\n            file_date: latestFile.mtime.toISOString(),\n            saved_to_history: save === \"true\"\n        });\n    } catch (error) {\n        console.error(\"Error processing CSV:\", error);\n        return res.status(500).json({\n            error: \"Error processing CSV file\",\n            details:  true ? error.message : 0\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q1JILGVBQWVHLGNBQWN4RCxNQUFNO1lBQ25DeUQsY0FBY2xGLGVBQWV5QixNQUFNO1lBQ25Dc0QsY0FBYyxJQUFJeEQsT0FBT0MsV0FBVztZQUNwQ3dELGdCQUFnQkwsV0FBV1osSUFBSTtZQUMvQm9CLFdBQVdSLFdBQVdYLEtBQUssQ0FBQ3hDLFdBQVc7WUFDdkM0RCxrQkFBa0JiLFNBQVM7UUFDN0I7SUFFRixFQUFFLE9BQU83QyxPQUFPO1FBQ2RuQixRQUFRbUIsS0FBSyxDQUFDLHlCQUF5QkE7UUFDdkMsT0FBT3lDLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDMUI1QyxPQUFPO1lBQ1AyRCxTQUFTbEcsS0FBeUIsR0FBZ0J1QyxNQUFNa0QsT0FBTyxHQUFHO1FBQ3BFO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2thaGYtY2FwaXRhbC13ZWJzaXRlLy4vcGFnZXMvYXBpL2Rhcmtwb29sLXRyYWRlcy5qcz9iZDk2Il0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCBjc3YgPSByZXF1aXJlKCdjc3YtcGFyc2VyJyk7XG5jb25zdCBjcmVhdGVDc3ZXcml0ZXIgPSByZXF1aXJlKCdjc3Ytd3JpdGVyJykuY3JlYXRlT2JqZWN0Q3N2V3JpdGVyO1xuXG4vLyBEYXRhIGRpcmVjdG9yeSBmb3IgQ1NWIGZpbGVzXG5jb25zdCBEQVRBX0RJUiA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZGF0YScpO1xuY29uc3QgREFJTFlfQ1NWX0RJUiA9IHBhdGguam9pbihEQVRBX0RJUiwgJ2RhaWx5Jyk7XG5jb25zdCBISVNUT1JJQ0FMX0NTVl9QQVRIID0gcGF0aC5qb2luKERBVEFfRElSLCAnZGFya3Bvb2xfaGlzdG9yeS5jc3YnKTtcblxuLy8gRW5zdXJlIGRpcmVjdG9yaWVzIGV4aXN0XG5mdW5jdGlvbiBlbnN1cmVEaXJlY3RvcmllcygpIHtcbiAgaWYgKCFmcy5leGlzdHNTeW5jKERBVEFfRElSKSkge1xuICAgIGZzLm1rZGlyU3luYyhEQVRBX0RJUiwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gIH1cbiAgaWYgKCFmcy5leGlzdHNTeW5jKERBSUxZX0NTVl9ESVIpKSB7XG4gICAgZnMubWtkaXJTeW5jKERBSUxZX0NTVl9ESVIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICB9XG59XG5cbi8vIFBhcnNlIENTViBmaWxlIGFuZCBleHRyYWN0IGRhcmsgcG9vbCB0cmFkZXMgd2l0aCBtZW1vcnkgbGltaXRzXG5mdW5jdGlvbiBwYXJzZURhcmtQb29sVHJhZGVzKGNzdkZpbGVQYXRoKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY29uc3QgZGFya1Bvb2xUcmFkZXMgPSBbXTtcbiAgICBsZXQgcm93Q291bnQgPSAwO1xuICAgIGNvbnN0IE1BWF9ST1dTID0gMTAwMDA7IC8vIExpbWl0IHRvIDEwayByb3dzIHRvIHByZXZlbnQgbWVtb3J5IGlzc3Vlc1xuICAgIFxuICAgIGZzLmNyZWF0ZVJlYWRTdHJlYW0oY3N2RmlsZVBhdGgpXG4gICAgICAucGlwZShjc3YoKSlcbiAgICAgIC5vbignZGF0YScsIChyb3cpID0+IHtcbiAgICAgICAgcm93Q291bnQrKztcbiAgICAgICAgXG4gICAgICAgIC8vIFN0b3AgcHJvY2Vzc2luZyBpZiB3ZSBoaXQgdGhlIGxpbWl0XG4gICAgICAgIGlmIChyb3dDb3VudCA+IE1BWF9ST1dTKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFJlYWNoZWQgcm93IGxpbWl0ICgke01BWF9ST1dTfSksIHN0b3BwaW5nIHByb2Nlc3NpbmdgKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgYSBkYXJrIHBvb2wgdHJhZGVcbiAgICAgICAgLy8gRGFyayBwb29sIHRyYWRlcyBoYXZlIGV4Y2hhbmdlID0gNCBBTkQgdHJmX2lkIHByZXNlbnRcbiAgICAgICAgaWYgKHJvdy5leGNoYW5nZSA9PT0gJzQnICYmIHJvdy50cmZfaWQgJiYgcm93LnRyZl9pZC50cmltKCkgIT09ICcnKSB7XG4gICAgICAgICAgZGFya1Bvb2xUcmFkZXMucHVzaCh7XG4gICAgICAgICAgICB0aWNrZXI6IHJvdy50aWNrZXIgfHwgcm93LnN5bWJvbCB8fCAnVU5LTk9XTicsXG4gICAgICAgICAgICB2b2x1bWU6IHBhcnNlSW50KHJvdy5zaXplIHx8IHJvdy52b2x1bWUgfHwgMCksXG4gICAgICAgICAgICBwcmljZTogcGFyc2VGbG9hdChyb3cucHJpY2UgfHwgcm93LnAgfHwgMCksXG4gICAgICAgICAgICB0aW1lc3RhbXA6IHJvdy50aW1lc3RhbXAgfHwgcm93LnQgfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgZXhjaGFuZ2U6IHJvdy5leGNoYW5nZSxcbiAgICAgICAgICAgIHRyZl9pZDogcm93LnRyZl9pZFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLm9uKCdlbmQnLCAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzZWQgJHtyb3dDb3VudH0gcm93cywgZm91bmQgJHtkYXJrUG9vbFRyYWRlcy5sZW5ndGh9IGRhcmsgcG9vbCB0cmFkZXNgKTtcbiAgICAgICAgcmVzb2x2ZShkYXJrUG9vbFRyYWRlcyk7XG4gICAgICB9KVxuICAgICAgLm9uKCdlcnJvcicsIChlcnJvcikgPT4ge1xuICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgfSk7XG4gIH0pO1xufVxuXG4vLyBHcm91cCBkYXJrIHBvb2wgdHJhZGVzIGJ5IHRpY2tlciBhbmQgY2FsY3VsYXRlIHRvdGFsc1xuZnVuY3Rpb24gZ3JvdXBUcmFkZXNCeVRpY2tlcih0cmFkZXMpIHtcbiAgY29uc3QgdGlja2VyTWFwID0ge307XG4gIFxuICB0cmFkZXMuZm9yRWFjaCh0cmFkZSA9PiB7XG4gICAgY29uc3QgdGlja2VyID0gdHJhZGUudGlja2VyLnRvVXBwZXJDYXNlKCk7XG4gICAgaWYgKCF0aWNrZXJNYXBbdGlja2VyXSkge1xuICAgICAgdGlja2VyTWFwW3RpY2tlcl0gPSB7XG4gICAgICAgIHRpY2tlcjogdGlja2VyLFxuICAgICAgICB0b3RhbF92b2x1bWU6IDAsXG4gICAgICAgIHRyYWRlX2NvdW50OiAwLFxuICAgICAgICBhdmdfcHJpY2U6IDAsXG4gICAgICAgIHRvdGFsX3ZhbHVlOiAwXG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICB0aWNrZXJNYXBbdGlja2VyXS50b3RhbF92b2x1bWUgKz0gdHJhZGUudm9sdW1lO1xuICAgIHRpY2tlck1hcFt0aWNrZXJdLnRyYWRlX2NvdW50ICs9IDE7XG4gICAgdGlja2VyTWFwW3RpY2tlcl0udG90YWxfdmFsdWUgKz0gdHJhZGUudm9sdW1lICogdHJhZGUucHJpY2U7XG4gIH0pO1xuICBcbiAgLy8gQ2FsY3VsYXRlIGF2ZXJhZ2UgcHJpY2VcbiAgT2JqZWN0LnZhbHVlcyh0aWNrZXJNYXApLmZvckVhY2godGlja2VyRGF0YSA9PiB7XG4gICAgdGlja2VyRGF0YS5hdmdfcHJpY2UgPSB0aWNrZXJEYXRhLnRvdGFsX3ZhbHVlIC8gdGlja2VyRGF0YS50b3RhbF92b2x1bWU7XG4gIH0pO1xuICBcbiAgLy8gQ29udmVydCB0byBhcnJheSBhbmQgc29ydCBieSB2b2x1bWVcbiAgcmV0dXJuIE9iamVjdC52YWx1ZXModGlja2VyTWFwKVxuICAgIC5zb3J0KChhLCBiKSA9PiBiLnRvdGFsX3ZvbHVtZSAtIGEudG90YWxfdm9sdW1lKTtcbn1cblxuLy8gU2F2ZSBkYXJrIHBvb2wgZGF0YSB0byBoaXN0b3JpY2FsIENTVlxuZnVuY3Rpb24gc2F2ZVRvSGlzdG9yaWNhbENTVih0cmFkZXMsIGRhdGUpIHtcbiAgY29uc3QgY3N2V3JpdGVyID0gY3JlYXRlQ3N2V3JpdGVyKHtcbiAgICBwYXRoOiBISVNUT1JJQ0FMX0NTVl9QQVRILFxuICAgIGhlYWRlcjogW1xuICAgICAgeyBpZDogJ2RhdGUnLCB0aXRsZTogJ0RBVEUnIH0sXG4gICAgICB7IGlkOiAndGlja2VyJywgdGl0bGU6ICdUSUNLRVInIH0sXG4gICAgICB7IGlkOiAndG90YWxfdm9sdW1lJywgdGl0bGU6ICdUT1RBTF9WT0xVTUUnIH0sXG4gICAgICB7IGlkOiAndHJhZGVfY291bnQnLCB0aXRsZTogJ1RSQURFX0NPVU5UJyB9LFxuICAgICAgeyBpZDogJ2F2Z19wcmljZScsIHRpdGxlOiAnQVZHX1BSSUNFJyB9LFxuICAgICAgeyBpZDogJ3RvdGFsX3ZhbHVlJywgdGl0bGU6ICdUT1RBTF9WQUxVRScgfVxuICAgIF0sXG4gICAgYXBwZW5kOiBmcy5leGlzdHNTeW5jKEhJU1RPUklDQUxfQ1NWX1BBVEgpXG4gIH0pO1xuICBcbiAgY29uc3QgcmVjb3JkcyA9IHRyYWRlcy5tYXAodHJhZGUgPT4gKHtcbiAgICBkYXRlOiBkYXRlLFxuICAgIHRpY2tlcjogdHJhZGUudGlja2VyLFxuICAgIHRvdGFsX3ZvbHVtZTogdHJhZGUudG90YWxfdm9sdW1lLFxuICAgIHRyYWRlX2NvdW50OiB0cmFkZS50cmFkZV9jb3VudCxcbiAgICBhdmdfcHJpY2U6IHRyYWRlLmF2Z19wcmljZS50b0ZpeGVkKDIpLFxuICAgIHRvdGFsX3ZhbHVlOiB0cmFkZS50b3RhbF92YWx1ZS50b0ZpeGVkKDIpXG4gIH0pKTtcbiAgXG4gIHJldHVybiBjc3ZXcml0ZXIud3JpdGVSZWNvcmRzKHJlY29yZHMpO1xufVxuXG4vLyBHZXQgbGF0ZXN0IENTViBmaWxlIGZyb20gZGFpbHkgZGlyZWN0b3J5IChwcmVmZXIgc21hbGxlciBmaWxlcyBmb3IgdGVzdGluZylcbmZ1bmN0aW9uIGdldExhdGVzdENTVkZpbGUoKSB7XG4gIGNvbnN0IGZpbGVzID0gZnMucmVhZGRpclN5bmMoREFJTFlfQ1NWX0RJUilcbiAgICAuZmlsdGVyKGZpbGUgPT4gZmlsZS5lbmRzV2l0aCgnLmNzdicpKVxuICAgIC5tYXAoZmlsZSA9PiB7XG4gICAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbihEQUlMWV9DU1ZfRElSLCBmaWxlKTtcbiAgICAgIGNvbnN0IHN0YXRzID0gZnMuc3RhdFN5bmMoZmlsZVBhdGgpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogZmlsZSxcbiAgICAgICAgcGF0aDogZmlsZVBhdGgsXG4gICAgICAgIG10aW1lOiBzdGF0cy5tdGltZSxcbiAgICAgICAgc2l6ZTogc3RhdHMuc2l6ZVxuICAgICAgfTtcbiAgICB9KVxuICAgIC5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAvLyBQcmVmZXIgc21hbGxlciBmaWxlcyAobGlrZSB0ZXN0LmNzdikgb3ZlciBsYXJnZSBmaWxlc1xuICAgICAgaWYgKGEuc2l6ZSA8IDEwMDAwMDAgJiYgYi5zaXplID49IDEwMDAwMDApIHJldHVybiAtMTtcbiAgICAgIGlmIChiLnNpemUgPCAxMDAwMDAwICYmIGEuc2l6ZSA+PSAxMDAwMDAwKSByZXR1cm4gMTtcbiAgICAgIC8vIFRoZW4gc29ydCBieSBtb2RpZmljYXRpb24gdGltZVxuICAgICAgcmV0dXJuIGIubXRpbWUgLSBhLm10aW1lO1xuICAgIH0pO1xuICBcbiAgcmV0dXJuIGZpbGVzLmxlbmd0aCA+IDAgPyBmaWxlc1swXSA6IG51bGw7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdHRVQnKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBlbnN1cmVEaXJlY3RvcmllcygpO1xuICAgIFxuICAgIGNvbnN0IHsgc2F2ZSA9ICdmYWxzZScgfSA9IHJlcS5xdWVyeTtcbiAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgIFxuICAgIC8vIEdldCB0aGUgbGF0ZXN0IENTViBmaWxlXG4gICAgY29uc3QgbGF0ZXN0RmlsZSA9IGdldExhdGVzdENTVkZpbGUoKTtcbiAgICBcbiAgICBpZiAoIWxhdGVzdEZpbGUpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICAgIGVycm9yOiAnTm8gQ1NWIGZpbGVzIGZvdW5kJyxcbiAgICAgICAgbWVzc2FnZTogYFBsZWFzZSB1cGxvYWQgYSBDU1YgZmlsZSB0byB0aGUgJHtEQUlMWV9DU1ZfRElSfSBkaXJlY3RvcnlgLFxuICAgICAgICBpbnN0cnVjdGlvbnM6IFtcbiAgICAgICAgICAnMS4gRG93bmxvYWQgeW91ciBQb2x5Z29uLmlvIENTViBmaWxlJyxcbiAgICAgICAgICAnMi4gVXBsb2FkIGl0IHRvIHRoZSBkYXRhL2RhaWx5IGZvbGRlcicsXG4gICAgICAgICAgJzMuIFJlZnJlc2ggdGhpcyBwYWdlIHRvIGFuYWx5emUgdGhlIGRhdGEnXG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyBDU1YgZmlsZTogJHtsYXRlc3RGaWxlLm5hbWV9YCk7XG4gICAgXG4gICAgLy8gUGFyc2UgdGhlIENTViBmaWxlXG4gICAgY29uc3QgZGFya1Bvb2xUcmFkZXMgPSBhd2FpdCBwYXJzZURhcmtQb29sVHJhZGVzKGxhdGVzdEZpbGUucGF0aCk7XG4gICAgXG4gICAgaWYgKGRhcmtQb29sVHJhZGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgZGF0ZTogY3VycmVudERhdGUsXG4gICAgICAgIHRyYWRlczogW10sXG4gICAgICAgIHRvdGFsX3RpY2tlcnM6IDAsXG4gICAgICAgIGxhc3RfdXBkYXRlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICBtZXNzYWdlOiAnTm8gZGFyayBwb29sIHRyYWRlcyBmb3VuZCBpbiB0aGUgQ1NWIGZpbGUnLFxuICAgICAgICBmaWxlX3Byb2Nlc3NlZDogbGF0ZXN0RmlsZS5uYW1lXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gR3JvdXAgdHJhZGVzIGJ5IHRpY2tlclxuICAgIGNvbnN0IGdyb3VwZWRUcmFkZXMgPSBncm91cFRyYWRlc0J5VGlja2VyKGRhcmtQb29sVHJhZGVzKTtcbiAgICBcbiAgICAvLyBTYXZlIHRvIGhpc3RvcmljYWwgQ1NWIGlmIHJlcXVlc3RlZFxuICAgIGlmIChzYXZlID09PSAndHJ1ZScpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHNhdmVUb0hpc3RvcmljYWxDU1YoZ3JvdXBlZFRyYWRlcywgY3VycmVudERhdGUpO1xuICAgICAgICBjb25zb2xlLmxvZyhgU2F2ZWQgJHtncm91cGVkVHJhZGVzLmxlbmd0aH0gdGlja2VycyB0byBoaXN0b3JpY2FsIENTVmApO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2F2aW5nIHRvIGhpc3RvcmljYWwgQ1NWOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgIGRhdGU6IGN1cnJlbnREYXRlLFxuICAgICAgdHJhZGVzOiBncm91cGVkVHJhZGVzLFxuICAgICAgdG90YWxfdGlja2VyczogZ3JvdXBlZFRyYWRlcy5sZW5ndGgsXG4gICAgICB0b3RhbF90cmFkZXM6IGRhcmtQb29sVHJhZGVzLmxlbmd0aCxcbiAgICAgIGxhc3RfdXBkYXRlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgZmlsZV9wcm9jZXNzZWQ6IGxhdGVzdEZpbGUubmFtZSxcbiAgICAgIGZpbGVfZGF0ZTogbGF0ZXN0RmlsZS5tdGltZS50b0lTT1N0cmluZygpLFxuICAgICAgc2F2ZWRfdG9faGlzdG9yeTogc2F2ZSA9PT0gJ3RydWUnXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwcm9jZXNzaW5nIENTVjonLCBlcnJvcik7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICBlcnJvcjogJ0Vycm9yIHByb2Nlc3NpbmcgQ1NWIGZpbGUnLFxuICAgICAgZGV0YWlsczogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBlcnJvci5tZXNzYWdlIDogJ1BsZWFzZSBjaGVjayB0aGUgQ1NWIGZpbGUgZm9ybWF0J1xuICAgIH0pO1xuICB9XG59XG5cblxuIl0sIm5hbWVzIjpbImZzIiwicmVxdWlyZSIsInBhdGgiLCJjc3YiLCJjcmVhdGVDc3ZXcml0ZXIiLCJjcmVhdGVPYmplY3RDc3ZXcml0ZXIiLCJEQVRBX0RJUiIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiREFJTFlfQ1NWX0RJUiIsIkhJU1RPUklDQUxfQ1NWX1BBVEgiLCJlbnN1cmVEaXJlY3RvcmllcyIsImV4aXN0c1N5bmMiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJwYXJzZURhcmtQb29sVHJhZGVzIiwiY3N2RmlsZVBhdGgiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImRhcmtQb29sVHJhZGVzIiwicm93Q291bnQiLCJNQVhfUk9XUyIsImNyZWF0ZVJlYWRTdHJlYW0iLCJwaXBlIiwib24iLCJyb3ciLCJjb25zb2xlIiwibG9nIiwiZXhjaGFuZ2UiLCJ0cmZfaWQiLCJ0cmltIiwicHVzaCIsInRpY2tlciIsInN5bWJvbCIsInZvbHVtZSIsInBhcnNlSW50Iiwic2l6ZSIsInByaWNlIiwicGFyc2VGbG9hdCIsInAiLCJ0aW1lc3RhbXAiLCJ0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwibGVuZ3RoIiwiZXJyb3IiLCJncm91cFRyYWRlc0J5VGlja2VyIiwidHJhZGVzIiwidGlja2VyTWFwIiwiZm9yRWFjaCIsInRyYWRlIiwidG9VcHBlckNhc2UiLCJ0b3RhbF92b2x1bWUiLCJ0cmFkZV9jb3VudCIsImF2Z19wcmljZSIsInRvdGFsX3ZhbHVlIiwiT2JqZWN0IiwidmFsdWVzIiwidGlja2VyRGF0YSIsInNvcnQiLCJhIiwiYiIsInNhdmVUb0hpc3RvcmljYWxDU1YiLCJkYXRlIiwiY3N2V3JpdGVyIiwiaGVhZGVyIiwiaWQiLCJ0aXRsZSIsImFwcGVuZCIsInJlY29yZHMiLCJtYXAiLCJ0b0ZpeGVkIiwid3JpdGVSZWNvcmRzIiwiZ2V0TGF0ZXN0Q1NWRmlsZSIsImZpbGVzIiwicmVhZGRpclN5bmMiLCJmaWx0ZXIiLCJmaWxlIiwiZW5kc1dpdGgiLCJmaWxlUGF0aCIsInN0YXRzIiwic3RhdFN5bmMiLCJuYW1lIiwibXRpbWUiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsInNhdmUiLCJxdWVyeSIsImN1cnJlbnREYXRlIiwic3BsaXQiLCJsYXRlc3RGaWxlIiwibWVzc2FnZSIsImluc3RydWN0aW9ucyIsInRvdGFsX3RpY2tlcnMiLCJsYXN0X3VwZGF0ZWQiLCJmaWxlX3Byb2Nlc3NlZCIsImdyb3VwZWRUcmFkZXMiLCJ0b3RhbF90cmFkZXMiLCJmaWxlX2RhdGUiLCJzYXZlZF90b19oaXN0b3J5IiwiZGV0YWlscyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/darkpool-trades.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdarkpool-trades&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdarkpool-trades.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();